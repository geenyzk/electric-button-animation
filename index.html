<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Next Level Electric Button Animation | @coding.stella</title>
  </head>
  <body>
    <!-- Matrix Rain Background Canvas -->
    <canvas id="matrixCanvas" class="matrix-bg"></canvas>
    
    <!-- Scanlines Overlay -->
    <div class="scanlines"></div>
    
    <!-- Cursor Trail Container -->
    <div id="cursorTrail" class="cursor-trail"></div>

    <!-- Click Counter -->
    <div class="click-counter" id="clickCounter">
      <span class="counter-label">CLICKS</span>
      <span class="counter-value" id="counterValue">0</span>
      <div class="counter-progress" id="counterProgress"></div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement" id="achievement">
      <span class="achievement-icon">üèÜ</span>
      <span class="achievement-text" id="achievementText">Achievement Unlocked!</span>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip">üí° Click me to power on!</div>

    <!-- Theme Picker UI -->
    <div class="theme-picker">
      <button class="theme-btn theme-btn-orange active" data-theme="" title="Orange">üî•</button>
      <button class="theme-btn theme-btn-blue" data-theme="theme-blue" title="Blue">üíé</button>
      <button class="theme-btn theme-btn-green" data-theme="theme-green" title="Green">üåø</button>
      <button class="theme-btn theme-btn-purple" data-theme="theme-purple" title="Purple">üîÆ</button>
      <button class="theme-btn theme-btn-rainbow" data-theme="theme-rainbow" title="Rainbow">üåà</button>
      <button class="theme-btn theme-btn-custom" id="customThemeBtn" title="Custom Color">üé®</button>
    </div>

    <!-- Custom Color Picker -->
    <div class="color-picker-panel" id="colorPickerPanel">
      <label>Glow Color: <input type="color" id="customGlow" value="#ff9f70"></label>
      <label>Spark Color: <input type="color" id="customSpark" value="#ffdd88"></label>
      <button id="applyCustomColor">Apply</button>
    </div>

    <!-- Size Picker UI -->
    <div class="size-picker">
      <button class="size-btn" data-size="size-small" title="Small">S</button>
      <button class="size-btn active" data-size="" title="Medium">M</button>
      <button class="size-btn" data-size="size-large" title="Large">L</button>
    </div>

    <!-- Confetti Container -->
    <div id="confettiContainer" class="confetti-container"></div>

    <!-- Lens Flare -->
    <div class="lens-flare" id="lensFlare"></div>

    <!-- Try: theme-blue, theme-green, theme-purple, theme-rainbow -->
    <div class="button-container" id="buttonContainer">
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <div class="area"></div>
      <button class="button" id="mainButton">
        <span class="ripple"></span>
        <!-- Charge indicator -->
        <div class="charge-indicator" id="chargeIndicator">
          <div class="charge-fill" id="chargeFill"></div>
          <span class="charge-text" id="chargeText">0%</span>
        </div>
        <!-- Heat distortion overlay -->
        <div class="heat-distortion"></div>
        <!-- Sound wave visualizer bars -->
        <div class="sound-waves">
          <span class="wave-bar"></span>
          <span class="wave-bar"></span>
          <span class="wave-bar"></span>
          <span class="wave-bar"></span>
          <span class="wave-bar"></span>
        </div>
        <!-- Electric arc effect -->
        <div class="electric-arc"></div>
        <!-- Smoke/steam particles -->
        <div class="smoke-particles">
          <span class="smoke"></span>
          <span class="smoke"></span>
          <span class="smoke"></span>
          <span class="smoke"></span>
          <span class="smoke"></span>
        </div>
        <!-- Glitch overlay -->
        <div class="glitch-overlay"></div>
        <!-- Energy charging bar -->
        <div class="energy-bar"></div>
        <div class="base"></div>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 52 42"
          height="25"
          width="50"
          class="filament"
        >
          <path
            stroke-width="3"
            stroke="var(--filament)"
            d="M1 11.5153C10.1667 12.6819 30.7 14.8153 39.5 14.0153C48.3 13.2153 50.1667 10.3486 50 9.01525C49.8333 6.84859 48.6 2.41525 45 2.01525C41.4 1.61525 39.8333 9.18192 39.5 13.0153V29.5153C39.5 32.5153 42 40.0153 45 40.0153C48 40.0153 50 37.5153 50 35.5153C50 33.5153 47.7 29.0153 38.5 27.0153C29.3 25.0153 9.66667 27.8486 1 29.5153"
          ></path>
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 52 42"
          height="25"
          width="50"
          class="filament filament-glow"
        >
          <defs>
            <linearGradient
              id="strokeGradient"
              x1="0%"
              y1="0%"
              x2="100%"
              y2="0%"
            >
              <stop offset="0%" stop-color="var(--filament)"></stop>
              <stop offset="100%" stop-color="var(--filament)"></stop>
            </linearGradient>
          </defs>
          <path
            d="M1 11.5153C10.1667 12.6819 30.7 14.8153 39.5 14.0153C48.3 13.2153 50.1667 10.3486 50 9.01525C49.8333 6.84859 48.6 2.41525 45 2.01525C41.4 1.61525 39.8333 9.18192 39.5 13.0153V29.5153C39.5 32.5153 42 40.0153 45 40.0153C48 40.0153 50 37.5153 50 35.5153C50 33.5153 47.7 29.0153 38.5 27.0153C29.3 25.0153 9.66667 27.8486 1 29.5153"
          ></path>
        </svg>
        <div class="glow"></div>
        <div class="lightning-marquee">
          <div>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
          </div>
          <div>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
            <svg
              viewBox="0 0 16 16"
              class="lightning"
              fill="var(--glow)"
              height="15"
              width="15"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"
              ></path>
            </svg>
          </div>
        </div>
        <p class="text">
          <span style="--i: 0">G</span>
          <span style="--i: 1">e</span>
          <span style="--i: 2">t</span>
          <span style="--i: 3">S</span>
          <span style="--i: 4">t</span>
          <span style="--i: 5">a</span>
          <span style="--i: 6">r</span>
          <span style="--i: 7">t</span>
          <span style="--i: 8">e</span>
          <span style="--i: 9">d</span>
        </p>
      </button>
      <div class="bulb-wrapper">
        <div class="bulb"></div>
        <svg
          viewBox="0 0 16 16"
          class="cursor select"
          stroke="#000"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M14.082 2.182a.5.5 0 0 1 .103.557L8.528 15.467a.5.5 0 0 1-.917-.007L5.57 10.694.803 8.652a.5.5 0 0 1-.006-.916l12.728-5.657a.5.5 0 0 1 .556.103z"
          ></path>
        </svg>
        <svg
          viewBox="0 0 16 16"
          class="cursor move"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10M.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8"
          ></path>
        </svg>
        <svg
          viewBox="0 0 16 16"
          class="cursor rotate"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"
          ></path>
          <path
            d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"
          ></path>
        </svg>
        <svg
          viewBox="0 0 16 16"
          class="cursor hammer"
          stroke="#000"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9.972 2.508a.5.5 0 0 0-.16-.556l-.178-.129a5 5 0 0 0-2.076-.783C6.215.862 4.504 1.229 2.84 3.133H1.786a.5.5 0 0 0-.354.147L.146 4.567a.5.5 0 0 0 0 .706l2.571 2.579a.5.5 0 0 0 .708 0l1.286-1.29a.5.5 0 0 0 .146-.353V5.57l8.387 8.873A.5.5 0 0 0 14 14.5l1.5-1.5a.5.5 0 0 0 .017-.689l-9.129-8.63c.747-.456 1.772-.839 3.112-.839a.5.5 0 0 0 .472-.334"
          ></path>
        </svg>
        <svg
          viewBox="0 0 16 16"
          class="cursor lightbulb-off"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"
          ></path>
        </svg>
        <svg
          viewBox="0 0 16 16"
          class="cursor lightbulb-on"
          fill="#fff"
          height="30"
          width="30"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13h-5a.5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m3 8.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1-.5-.5"
          ></path>
        </svg>
      </div>
    </div>

    <!-- Reflection element -->
    <div class="button-reflection"></div>

    <!-- JavaScript for all interactive features -->
    <script>
      // ===== AUDIO CONTEXT FOR SOUND EFFECTS =====
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      let audioCtx = null;
      
      function initAudio() {
        if (!audioCtx) {
          audioCtx = new AudioContext();
        }
      }
      
      function playSound(type) {
        initAudio();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        
        switch(type) {
          case 'click':
            oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.1);
            break;
          case 'powerOn':
            oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.3);
            break;
          case 'powerOff':
            oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.2);
            gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.2);
            break;
          case 'buzz':
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(60, audioCtx.currentTime);
            gainNode.gain.setValueAtTime(0.05, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.5);
            break;
          case 'charge':
            oscillator.frequency.setValueAtTime(100, audioCtx.currentTime);
            oscillator.frequency.linearRampToValueAtTime(1000, audioCtx.currentTime + 2);
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            oscillator.start(audioCtx.currentTime);
            return { oscillator, gainNode }; // Return for stopping later
          case 'achievement':
            oscillator.frequency.setValueAtTime(523, audioCtx.currentTime);
            oscillator.frequency.setValueAtTime(659, audioCtx.currentTime + 0.1);
            oscillator.frequency.setValueAtTime(784, audioCtx.currentTime + 0.2);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            oscillator.start(audioCtx.currentTime);
            oscillator.stop(audioCtx.currentTime + 0.4);
            break;
        }
      }

      // ===== STATE MANAGEMENT =====
      let isOn = false;
      let clickCount = parseInt(localStorage.getItem('clickCount') || '0');
      let isCharging = false;
      let chargeLevel = 0;
      let chargeInterval = null;
      let chargeSound = null;
      const achievements = JSON.parse(localStorage.getItem('achievements') || '{}');

      // ===== DOM ELEMENTS =====
      const mainButton = document.getElementById('mainButton');
      const container = document.getElementById('buttonContainer');
      const counterValue = document.getElementById('counterValue');
      const counterProgress = document.getElementById('counterProgress');
      const tooltip = document.getElementById('tooltip');
      const achievement = document.getElementById('achievement');
      const achievementText = document.getElementById('achievementText');
      const chargeIndicator = document.getElementById('chargeIndicator');
      const chargeFill = document.getElementById('chargeFill');
      const chargeText = document.getElementById('chargeText');
      const lensFlare = document.getElementById('lensFlare');
      const confettiContainer = document.getElementById('confettiContainer');
      const matrixCanvas = document.getElementById('matrixCanvas');

      // Initialize counter display
      counterValue.textContent = clickCount;
      updateCounterProgress();

      // Hide tooltip if not first visit
      if (localStorage.getItem('visited')) {
        tooltip.style.display = 'none';
      } else {
        setTimeout(() => {
          tooltip.classList.add('show');
        }, 1000);
      }

      // ===== TOGGLE ON/OFF STATE =====
      function toggleButton() {
        isOn = !isOn;
        container.classList.toggle('is-on', isOn);
        
        if (isOn) {
          playSound('powerOn');
          lensFlare.classList.add('active');
          createConfetti();
          setTimeout(() => playSound('buzz'), 300);
        } else {
          playSound('powerOff');
          lensFlare.classList.remove('active');
        }
        
        // Haptic feedback on mobile
        if (navigator.vibrate) {
          navigator.vibrate(isOn ? [50, 30, 50] : [30]);
        }
      }

      // ===== CLICK COUNTER & ACHIEVEMENTS =====
      function incrementCounter() {
        clickCount++;
        counterValue.textContent = clickCount;
        localStorage.setItem('clickCount', clickCount);
        updateCounterProgress();
        checkAchievements();
        
        // Animate counter
        counterValue.classList.add('pulse');
        setTimeout(() => counterValue.classList.remove('pulse'), 200);
      }

      function updateCounterProgress() {
        const progress = (clickCount % 100) / 100 * 100;
        counterProgress.style.width = progress + '%';
      }

      function checkAchievements() {
        const milestones = {
          10: { text: 'First Steps! 10 clicks!', icon: 'üéØ' },
          50: { text: 'Getting Warmed Up! 50 clicks!', icon: 'üî•' },
          100: { text: 'Century! 100 clicks!', icon: 'üíØ' },
          500: { text: 'Power User! 500 clicks!', icon: '‚ö°' },
          1000: { text: 'LEGENDARY! 1000 clicks!', icon: 'üëë' }
        };
        
        if (milestones[clickCount] && !achievements[clickCount]) {
          achievements[clickCount] = true;
          localStorage.setItem('achievements', JSON.stringify(achievements));
          showAchievement(milestones[clickCount].text, milestones[clickCount].icon);
        }
      }

      function showAchievement(text, icon = 'üèÜ') {
        playSound('achievement');
        document.querySelector('.achievement-icon').textContent = icon;
        achievementText.textContent = text;
        achievement.classList.add('show');
        
        // Super confetti for achievements!
        for (let i = 0; i < 3; i++) {
          setTimeout(() => createConfetti(50), i * 200);
        }
        
        setTimeout(() => {
          achievement.classList.remove('show');
        }, 3000);
      }

      // ===== CONFETTI EXPLOSION =====
      function createConfetti(count = 30) {
        const colors = ['#ff6b6b', '#ffd93d', '#6bcb77', '#4d96ff', '#9b59b6', '#ff9f70'];
        
        for (let i = 0; i < count; i++) {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = '50%';
          confetti.style.top = '50%';
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.setProperty('--x', (Math.random() - 0.5) * 500 + 'px');
          confetti.style.setProperty('--y', (Math.random() - 0.5) * 500 + 'px');
          confetti.style.setProperty('--r', Math.random() * 720 + 'deg');
          confettiContainer.appendChild(confetti);
          
          setTimeout(() => confetti.remove(), 1000);
        }
      }

      // ===== HOLD-TO-CHARGE MECHANIC =====
      function startCharging() {
        if (isCharging) return;
        isCharging = true;
        chargeLevel = 0;
        chargeIndicator.classList.add('active');
        chargeSound = playSound('charge');
        
        chargeInterval = setInterval(() => {
          chargeLevel = Math.min(chargeLevel + 2, 100);
          chargeFill.style.width = chargeLevel + '%';
          chargeText.textContent = chargeLevel + '%';
          
          if (chargeLevel >= 100) {
            releaseCharge(true);
          }
        }, 40);
      }

      function releaseCharge(maxCharge = false) {
        if (!isCharging) return;
        isCharging = false;
        clearInterval(chargeInterval);
        
        if (chargeSound) {
          chargeSound.oscillator.stop();
          chargeSound.gainNode.disconnect();
        }
        
        chargeIndicator.classList.remove('active');
        
        if (chargeLevel > 20) {
          // Trigger based on charge level
          const intensity = chargeLevel / 100;
          createConfetti(Math.floor(intensity * 50));
          
          if (maxCharge) {
            showAchievement('MAXIMUM POWER! ‚ö°', 'üí•');
            container.classList.add('super-charged');
            setTimeout(() => container.classList.remove('super-charged'), 1000);
          }
        }
        
        chargeLevel = 0;
        chargeFill.style.width = '0%';
        chargeText.textContent = '0%';
      }

      // ===== MAGNETIC CURSOR EFFECT =====
      let magneticStrength = 0.15;
      
      function handleMagneticEffect(e) {
        const rect = mainButton.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        
        const deltaX = e.clientX - centerX;
        const deltaY = e.clientY - centerY;
        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
        
        if (distance < 200) {
          const pull = (200 - distance) / 200 * magneticStrength;
          const moveX = deltaX * pull;
          const moveY = deltaY * pull;
          
          mainButton.style.transform = `translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px))`;
        } else {
          mainButton.style.transform = '';
        }
      }

      // ===== CURSOR TRAIL =====
      const trailContainer = document.getElementById('cursorTrail');
      const trailParticles = [];
      const maxTrailParticles = 20;

      function createTrailParticle(x, y) {
        const particle = document.createElement('div');
        particle.className = 'trail-particle';
        particle.style.left = x + 'px';
        particle.style.top = y + 'px';
        trailContainer.appendChild(particle);
        
        trailParticles.push({
          element: particle,
          life: 1
        });
        
        if (trailParticles.length > maxTrailParticles) {
          const oldest = trailParticles.shift();
          oldest.element.remove();
        }
      }

      function updateTrailParticles() {
        trailParticles.forEach((p, i) => {
          p.life -= 0.05;
          p.element.style.opacity = p.life;
          p.element.style.transform = `scale(${p.life})`;
          
          if (p.life <= 0) {
            p.element.remove();
            trailParticles.splice(i, 1);
          }
        });
        requestAnimationFrame(updateTrailParticles);
      }
      updateTrailParticles();

      // ===== MATRIX RAIN BACKGROUND =====
      const ctx = matrixCanvas.getContext('2d');
      matrixCanvas.width = window.innerWidth;
      matrixCanvas.height = window.innerHeight;
      
      const chars = '01„Ç¢„Ç§„Ç¶„Ç®„Ç™„Ç´„Ç≠„ÇØ„Ç±„Ç≥„Çµ„Ç∑„Çπ„Çª„ÇΩ„Çø„ÉÅ„ÉÑ„ÉÜ„Éà„Éä„Éã„Éå„Éç„Éé„Éè„Éí„Éï„Éò„Éõ„Éû„Éü„É†„É°„É¢„É§„É¶„É®„É©„É™„É´„É¨„É≠„ÉØ„É≤„É≥';
      const fontSize = 14;
      const columns = matrixCanvas.width / fontSize;
      const drops = Array(Math.floor(columns)).fill(1);
      let matrixEnabled = false;

      function drawMatrix() {
        if (!matrixEnabled) return;
        
        ctx.fillStyle = 'rgba(13, 16, 14, 0.05)';
        ctx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
        
        ctx.fillStyle = '#0f0';
        ctx.font = fontSize + 'px monospace';
        
        for (let i = 0; i < drops.length; i++) {
          const text = chars[Math.floor(Math.random() * chars.length)];
          ctx.fillText(text, i * fontSize, drops[i] * fontSize);
          
          if (drops[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
            drops[i] = 0;
          }
          drops[i]++;
        }
        
        requestAnimationFrame(drawMatrix);
      }

      // ===== CUSTOM COLOR PICKER =====
      const customThemeBtn = document.getElementById('customThemeBtn');
      const colorPickerPanel = document.getElementById('colorPickerPanel');
      const customGlow = document.getElementById('customGlow');
      const customSpark = document.getElementById('customSpark');
      const applyCustomColor = document.getElementById('applyCustomColor');

      customThemeBtn.addEventListener('click', () => {
        colorPickerPanel.classList.toggle('show');
      });

      applyCustomColor.addEventListener('click', () => {
        container.style.setProperty('--glow', customGlow.value);
        container.style.setProperty('--spark-color', customSpark.value);
        container.style.setProperty('--glow-alt', customGlow.value);
        colorPickerPanel.classList.remove('show');
        playSound('click');
        
        // Remove other theme classes
        container.classList.remove('theme-blue', 'theme-green', 'theme-purple', 'theme-rainbow');
        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
        customThemeBtn.classList.add('active');
      });

      // ===== KEYBOARD SHORTCUTS =====
      document.addEventListener('keydown', (e) => {
        switch(e.key) {
          case '1': document.querySelector('[data-theme=""]').click(); break;
          case '2': document.querySelector('[data-theme="theme-blue"]').click(); break;
          case '3': document.querySelector('[data-theme="theme-green"]').click(); break;
          case '4': document.querySelector('[data-theme="theme-purple"]').click(); break;
          case '5': document.querySelector('[data-theme="theme-rainbow"]').click(); break;
          case '+':
          case '=':
            document.querySelector('[data-size="size-large"]').click(); break;
          case '-':
            document.querySelector('[data-size="size-small"]').click(); break;
          case '0':
            document.querySelector('[data-size=""]').click(); break;
          case 'm':
            matrixEnabled = !matrixEnabled;
            matrixCanvas.classList.toggle('active', matrixEnabled);
            if (matrixEnabled) drawMatrix();
            break;
          case ' ':
            e.preventDefault();
            mainButton.click();
            break;
        }
      });

      // ===== EASTER EGGS =====
      let konamiCode = [];
      const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

      document.addEventListener('keydown', (e) => {
        konamiCode.push(e.key);
        konamiCode = konamiCode.slice(-10);
        
        if (konamiCode.join(',') === konamiSequence.join(',')) {
          showAchievement('KONAMI CODE ACTIVATED! üéÆ', 'üïπÔ∏è');
          container.classList.add('rainbow-mode');
          createConfetti(100);
          setTimeout(() => container.classList.remove('rainbow-mode'), 5000);
        }
      });

      // Triple click easter egg
      let clickTimes = [];
      mainButton.addEventListener('click', () => {
        const now = Date.now();
        clickTimes.push(now);
        clickTimes = clickTimes.filter(t => now - t < 500);
        
        if (clickTimes.length >= 5) {
          showAchievement('SPEED CLICKER! üèÉ‚Äç‚ôÇÔ∏è', '‚ö°');
          clickTimes = [];
        }
      });

      // ===== EVENT LISTENERS =====
      
      // Theme picker
      document.querySelectorAll('.theme-btn:not(#customThemeBtn)').forEach(btn => {
        btn.addEventListener('click', () => {
          container.classList.remove('theme-blue', 'theme-green', 'theme-purple', 'theme-rainbow');
          container.style.removeProperty('--glow');
          container.style.removeProperty('--spark-color');
          container.style.removeProperty('--glow-alt');
          
          const theme = btn.dataset.theme;
          if (theme) container.classList.add(theme);
          
          document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          playSound('click');
        });
      });

      // Size picker
      document.querySelectorAll('.size-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          container.classList.remove('size-small', 'size-large');
          const size = btn.dataset.size;
          if (size) container.classList.add(size);
          
          document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          playSound('click');
        });
      });

      // Main button click
      mainButton.addEventListener('click', (e) => {
        // Ripple position
        const ripple = mainButton.querySelector('.ripple');
        const rect = mainButton.getBoundingClientRect();
        ripple.style.left = (e.clientX - rect.left) + 'px';
        ripple.style.top = (e.clientY - rect.top) + 'px';
        
        toggleButton();
        incrementCounter();
        
        // Hide tooltip on first click
        if (!localStorage.getItem('visited')) {
          localStorage.setItem('visited', 'true');
          tooltip.classList.remove('show');
          setTimeout(() => tooltip.style.display = 'none', 500);
        }
      });

      // Hold-to-charge
      mainButton.addEventListener('mousedown', startCharging);
      mainButton.addEventListener('touchstart', startCharging);
      mainButton.addEventListener('mouseup', () => releaseCharge());
      mainButton.addEventListener('touchend', () => releaseCharge());
      mainButton.addEventListener('mouseleave', () => releaseCharge());

      // Magnetic cursor
      document.addEventListener('mousemove', (e) => {
        handleMagneticEffect(e);
        createTrailParticle(e.clientX, e.clientY);
      });

      // Window resize for matrix
      window.addEventListener('resize', () => {
        matrixCanvas.width = window.innerWidth;
        matrixCanvas.height = window.innerHeight;
      });

      // ===== STARTUP =====
      console.log('%c‚ö° Electric Button v2.0 ‚ö°', 'font-size: 20px; color: #ff9f70; text-shadow: 0 0 10px #ff9f70;');
      console.log('%cKeyboard shortcuts: 1-5 (themes), +/- (size), M (matrix), Space (click)', 'color: #888;');
      console.log('%cTry the Konami Code! ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA', 'color: #4d96ff;');
    </script>
  </body>
</html>
